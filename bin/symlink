#!/usr/bin/env bash

HELP="Script create or remove a symbolic link /var/www to the project directory.

  $(basename "$0") <action>

    <action>          script execution action
      -c, --create    creating a symbolic link
      -r, --remove    removing a symbolic link
      -h, --help      display this help"

if [ "$1" = -h ] || [ "$1" = --help ]; then
  echo "$HELP" && exit
fi

case "$1" in
  -c|--create)
    PROJECT_DIR="$(readlink --canonicalize "$(dirname "$0")/../..")"
    $0 -r && cd /var &> /dev/null || exit 1 && sudo ln -s "$PROJECT_DIR" www && cd - &> /dev/null || exit 1
  ;;
  -r|--remove)
    if [ -s /var/www ]; then sudo rm /var/www; fi
  ;;
  *)
    printf "error: Required parameter(s) are not specified\n\n%s\n" "$HELP" && exit 1
  ;;
esac
